<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{title}}</title>
  <link rel="stylesheet" href="/public/css/main.css">
  <link rel="stylesheet" href="/public/css/station.css">
</head>
<body>
  <h1>{{name}}</h1>

  {{#if error}}
    <div class="error">{{error}}</div>
  {{/if}}

  <section class="station-layout">
      {{!-- Left Column: Station Details --}}
      <section class="station-info" aria-label="Station Information">
          <h2>Station Information</h2>

          <section class="ada-summary">
              <h3>ADA Summary</h3>
              <p>Status: <strong>{{adaStatus}}</strong></p>
              {{#if adaNotes}}
                <p>{{adaNotes}}</p>
              {{/if}}
          </section>

          <section class="outage-summary">
              <h3>Historical Outage Summary</h3>
              <ul>
                  {{#each outages}}
                      <li>{{this.date}} - {{this.description}}</li>
                  {{/each}}
              </ul>
          </section>

          <section class="nearby-crossings">
              <h3>Nearby Crossings</h3>
              {{#if nearbyCrossings.length}}
                <ul>
                    {{#each nearbyCrossings}}
                        <li>
                            <a href="/crossing/{{this.apsId}}">{{this.address}}</a>
                            <br>
                            <small>Distance: {{this.distance}} km</small>
                        </li>
                    {{/each}}
                </ul>
              {{else}}
                <p class="no-outages">No crossings found nearby.</p>
              {{/if}}
          </section>
      </section>

      {{!-- Right Column: Community Reports --}}
      <section class="station-sidepanel" aria-label="Community Reports">
          <section class="community-reports">
              <h2>Community Reports</h2>
              
                {{!-- List of Reports --}}
              <div class="reports-list">
                  {{#if reports.length}}
                      <ul>
                          {{#each reports}}
                              <li>
                                  <div class="report report-{{this.status}}" data-report-id="{{this._id}}">
                                      <p class="report-text">{{this.text}}</p>
                                      {{#if this.photo}}
                                          <img src="{{this.photo}}" alt="Report Photo" loading="lazy" class="report-photo" />
                                      {{/if}}
                                      <div class="report-meta">
                                          <span class="votes">Trust Score: <span class="trust-score">{{this.trustScore}}</span></span>
                                          <span class="report-status">{{this.status}}</span>
                                          <span class="report-time">{{this.createdAt}}</span>
                                      </div>
                                      {{#if this.duplicate}}
                                          <div class="duplicate-flag">Marked as duplicate</div>
                                      {{/if}}
                                      <div class="report-actions">
                                          <button class="vote-btn" data-report-id="{{this._id}}" data-vote-type="up">üëç Helpful</button>
                                          <button class="vote-btn" data-report-id="{{this._id}}" data-vote-type="down">üëé Not Helpful</button>
                                          <button class="flag-duplicate-btn" data-report-id="{{this._id}}">Flag Duplicate</button>
                                      </div>
                                  </div>
                              </li>
                          {{/each}}
                      </ul>
                  {{else}}
                      <p class="no-reports">No reports yet. Be the first to report an accessibility issue!</p>
                  {{/if}}
              </div>

              {{!-- Report Submission Form --}}
              <form id="report-form" class="report-form">
                  <h3>Submit a Report</h3>
                  <textarea 
                      name="reportText" 
                      placeholder="Describe the accessibility issue (e.g., elevator out of service, broken ramp, etc.)..." 
                      required
                      minlength="10"
                      maxlength="500"
                      rows="4"
                  ></textarea>
                  
                  <label for="report-photo">
                      Photo (optional):
                      <input type="file" id="report-photo" name="photo" accept="image/*">
                  </label>

                  <button type="submit">Submit Report</button>
              </form>

              
          </section>
      </section>
  </section>

  {{!-- Station JS --}}
  <script src="/public/js/station.js"></script>
</body>
</html>