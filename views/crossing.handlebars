<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{title}}</title>
  <link rel="stylesheet" href="/public/css/main.css">
  <link rel="stylesheet" href="/public/css/station.css">
</head>
<body>
  <h1>{{address}}</h1>

  {{#if error}}
    <div class="error">{{error}}</div>
  {{/if}}

  <section class="station-layout">
      {{!-- Left Column: Crossing Details --}}
      <section class="station-info" aria-label="Crossing Information">
          <h2>Crossing Information</h2>

          <section class="ada-summary">
              <h3>Location Details</h3>
              <p><strong>Address:</strong> {{address}}</p>
              <p><strong>Borough:</strong> {{borough}}</p>
              <p><strong>APS ID:</strong> {{apsId}}</p>
              {{#if installDate}}
                <p><strong>Install Date:</strong> {{installDate}}</p>
              {{/if}}
              <p><strong>Coordinates:</strong> {{lat}}, {{lng}}</p>
          </section>

          <section class="outage-summary">
              <h3>Nearby Curb Ramps</h3>
              {{#if nearbyCurbRamps.length}}
                <ul>
                    {{#each nearbyCurbRamps}}
                        <li>
                            <strong>{{this.attributes.streetName}}</strong>
                            <br>
                            Condition: <span class="condition-{{this.attributes.downSlopeCondition}}">{{this.attributes.downSlopeCondition}}</span>
                            <br>
                            <small>Distance: {{this.distance}} km</small>
                        </li>
                    {{/each}}
                </ul>
              {{else}}
                <p class="no-outages">No curb ramps found nearby.</p>
              {{/if}}
          </section>

          <section class="nearby-crossings">
              <h3>Additional Features</h3>
              <p><em>Coming soon...</em></p>
          </section>
      </section>

      {{!-- Right Column: Community Reports --}}
      <section class="station-sidepanel" aria-label="Community Reports">
          <section class="community-reports">
              <h2>Community Reports</h2>
              
              {{!-- Report Submission Form --}}
              <form id="report-form" class="report-form">
                  <h3>Submit a Report</h3>
                  <textarea 
                      name="reportText" 
                      placeholder="Describe the accessibility issue at this crossing (e.g., APS not working, signal timing issues, etc.)..." 
                      required
                      minlength="10"
                      maxlength="500"
                      rows="4"
                  ></textarea>
                  
                  <label for="report-photo">
                      Photo (optional):
                      <input type="file" id="report-photo" name="photo" accept="image/*">
                  </label>

                  <button type="submit">Submit Report</button>
              </form>

              {{!-- List of Reports --}}
              <div class="reports-list">
                  {{#if reports.length}}
                      <ul>
                          {{#each reports}}
                              <li>
                                  <div class="report report-{{this.status}}" data-report-id="{{this._id}}">
                                      <p class="report-text">{{this.text}}</p>
                                      {{#if this.photo}}
                                          <img src="{{this.photo}}" alt="Report Photo" loading="lazy" class="report-photo" />
                                      {{/if}}
                                      <div class="report-meta">
                                          <span class="votes">Trust Score: <span class="trust-score">{{this.trustScore}}</span></span>
                                          <span class="report-status">{{this.status}}</span>
                                          <span class="report-time">{{this.createdAt}}</span>
                                      </div>
                                      {{#if this.duplicate}}
                                          <div class="duplicate-flag">Marked as duplicate</div>
                                      {{/if}}
                                      <div class="report-actions">
                                          <button class="vote-btn" data-report-id="{{this._id}}" data-vote-type="up">üëç Helpful</button>
                                          <button class="vote-btn" data-report-id="{{this._id}}" data-vote-type="down">üëé Not Helpful</button>
                                          <button class="flag-duplicate-btn" data-report-id="{{this._id}}">Flag Duplicate</button>
                                      </div>
                                  </div>
                              </li>
                          {{/each}}
                      </ul>
                  {{else}}
                      <p class="no-reports">No reports yet. Be the first to report an accessibility issue!</p>
                  {{/if}}
              </div>
          </section>
      </section>
  </section>

  {{!-- Crossing JS --}}
  <script src="/public/js/crossing.js"></script>
</body>
</html>